name: Chrome Remote Desktop

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:

    - name: Set up job
      run: |
        sudo apt update

    - name: Install Desktop Environment
      run: |
        sudo apt install -y xfce4 xfce4-goodies

    - name: Install Chrome Remote Desktop
      run: |
        wget https://dl.google.com/linux/direct/chrome-remote-desktop_current_amd64.deb
        sudo apt install -y ./chrome-remote-desktop_current_amd64.deb

    - name: Configure Desktop
      run: |
        echo "exec /usr/bin/xfce4-session" > ~/.chrome-remote-desktop-session
        sudo systemctl disable lightdm.service

    - name: Start Chrome Remote Desktop
      run: | 
       DISPLAY= /opt/google/chrome-remote-desktop/start-host \
--code="4/0ASc3gC2g16sH8RMCW7Zy5DubWAUBLy7frBBqTrrzJmq1FfIPXie1IL608fz9qdlKgXTVgQ" \
--redirect-url="https://remotedesktop.google.com/_/oauthredirect" \
--name=$(hostname) \
--pin=123456
  
